<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PPS-Client: client/pps-serial.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PPS-Client
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">Client for synchronizing the system clock to a GPS PPS source</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_db3a54907829b36871118d03417739cd.html">client</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pps-serial.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains functions and structures for accessing GPS time updates via the serial port.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../d4/d6a/pps-client_8h_source.html">../client/pps-client.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pps-serial.cpp:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/dc1/pps-serial_8cpp__incl.svg" width="164" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="../../df/d28/pps-serial_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>serialLocalVars</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a666789a6e60ff76ea7dfc58bdb785d9b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a666789a6e60ff76ea7dfc58bdb785d9b">MSG_WAIT_TIME</a>&#160;&#160;&#160;990000</td></tr>
<tr class="separator:a666789a6e60ff76ea7dfc58bdb785d9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11528d10d5838afd2d0ec2f5841167cf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a11528d10d5838afd2d0ec2f5841167cf">SECS_PER_HOUR</a>&#160;&#160;&#160;3600</td></tr>
<tr class="separator:a11528d10d5838afd2d0ec2f5841167cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ad476575dd10e03346d6d586ca67ae"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#aa8ad476575dd10e03346d6d586ca67ae">VERIFY_NUM</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:aa8ad476575dd10e03346d6d586ca67ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd911bc0629025dec4c0b863faf897d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a3cd911bc0629025dec4c0b863faf897d">MAX_NOT_READY</a>&#160;&#160;&#160;60</td></tr>
<tr class="separator:a3cd911bc0629025dec4c0b863faf897d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a21ca2cd625bad50c61e837880ac75c55"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a21ca2cd625bad50c61e837880ac75c55">getUTCfromGPSmessages</a> (const char *msgbuf, <a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp, time_t *gmt0Seconds)</td></tr>
<tr class="separator:a21ca2cd625bad50c61e837880ac75c55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4749205b4ede5570376cf2d476014337"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a4749205b4ede5570376cf2d476014337">saveTimestamps</a> (int gmt0Seconds, int gmtSeconds, int tv_usec, <a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:a4749205b4ede5570376cf2d476014337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c41bc5e42885fab2e7f99876865476"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a98c41bc5e42885fab2e7f99876865476">read_save</a> (int captureTime, <a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:a98c41bc5e42885fab2e7f99876865476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a017c6d120d7bd920065a7fece4d53978"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a017c6d120d7bd920065a7fece4d53978">saveGPSTime</a> (<a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:a017c6d120d7bd920065a7fece4d53978"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90b59dcade2c7323b79780215baae4fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a90b59dcade2c7323b79780215baae4fd">makeSerialTimeQuery</a> (<a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:a90b59dcade2c7323b79780215baae4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab10bb47e214849a31ac6c87556bed416"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#ab10bb47e214849a31ac6c87556bed416">allocInitializeSerialThread</a> (<a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:ab10bb47e214849a31ac6c87556bed416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f4271a6bb9ed778df76908d570a0660"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a5f4271a6bb9ed778df76908d570a0660">freeSerialThread</a> (<a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:a5f4271a6bb9ed778df76908d570a0660"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6fc43fe650a73ed6e4567288c6e1c6bd"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dc/d1d/struct_g.html">G</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a6fc43fe650a73ed6e4567288c6e1c6bd">g</a></td></tr>
<tr class="memdesc:a6fc43fe650a73ed6e4567288c6e1c6bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declares the global variables defined in <a class="el" href="../../d4/d6a/pps-client_8h.html" title="This file contains includes, defines and structures for PPS-Client.">pps-client.h</a>.  <a href="../../df/d28/pps-serial_8cpp.html#a6fc43fe650a73ed6e4567288c6e1c6bd">More...</a><br /></td></tr>
<tr class="separator:a6fc43fe650a73ed6e4567288c6e1c6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06ca16ef16c65999f92e782aa19013bd"><td class="memItemLeft" align="right" valign="top">struct ppsFiles&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/d28/pps-serial_8cpp.html#a06ca16ef16c65999f92e782aa19013bd">f</a></td></tr>
<tr class="memdesc:a06ca16ef16c65999f92e782aa19013bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">PPS-Client internal files.  <a href="../../df/d28/pps-serial_8cpp.html#a06ca16ef16c65999f92e782aa19013bd">More...</a><br /></td></tr>
<tr class="separator:a06ca16ef16c65999f92e782aa19013bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains functions and structures for accessing GPS time updates via the serial port. </p>

<p class="definition">Definition in file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3cd911bc0629025dec4c0b863faf897d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd911bc0629025dec4c0b863faf897d">&#9670;&nbsp;</a></span>MAX_NOT_READY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_NOT_READY&#160;&#160;&#160;60</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00030">30</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

</div>
</div>
<a id="a666789a6e60ff76ea7dfc58bdb785d9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a666789a6e60ff76ea7dfc58bdb785d9b">&#9670;&nbsp;</a></span>MSG_WAIT_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_WAIT_TIME&#160;&#160;&#160;990000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00027">27</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

</div>
</div>
<a id="a11528d10d5838afd2d0ec2f5841167cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11528d10d5838afd2d0ec2f5841167cf">&#9670;&nbsp;</a></span>SECS_PER_HOUR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SECS_PER_HOUR&#160;&#160;&#160;3600</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00028">28</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

</div>
</div>
<a id="aa8ad476575dd10e03346d6d586ca67ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ad476575dd10e03346d6d586ca67ae">&#9670;&nbsp;</a></span>VERIFY_NUM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VERIFY_NUM&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00029">29</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab10bb47e214849a31ac6c87556bed416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab10bb47e214849a31ac6c87556bed416">&#9670;&nbsp;</a></span>allocInitializeSerialThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int allocInitializeSerialThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocates memory and initializes a thread that will be used by makeSerialimeQuery() to query the serial port. Thread must be released and memory deleted by calling <a class="el" href="../../df/d28/pps-serial_8cpp.html#a5f4271a6bb9ed778df76908d570a0660">freeSerialThread()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tcp</td><td>Struct pointer for passing data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success or -1 on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00417">417</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01250">waitForPPS()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/d28/pps-serial_8cpp_ab10bb47e214849a31ac6c87556bed416_icgraph.svg" width="344" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a5f4271a6bb9ed778df76908d570a0660"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f4271a6bb9ed778df76908d570a0660">&#9670;&nbsp;</a></span>freeSerialThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freeSerialThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Releases thread and deletes memory used by <a class="el" href="../../df/d28/pps-serial_8cpp.html#a90b59dcade2c7323b79780215baae4fd">makeSerialTimeQuery()</a>;</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tcp</td><td>The struct pointer that was used for passing data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00464">464</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00148">timeCheckParams::attr</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00152">timeCheckParams::serialPort</a>, and <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00155">timeCheckParams::strbuf</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01250">waitForPPS()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/d28/pps-serial_8cpp_a5f4271a6bb9ed778df76908d570a0660_icgraph.svg" width="284" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a21ca2cd625bad50c61e837880ac75c55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21ca2cd625bad50c61e837880ac75c55">&#9670;&nbsp;</a></span>getUTCfromGPSmessages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool getUTCfromGPSmessages </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msgbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>gmt0Seconds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Processes a block of GPS messages to find a GPRMC message and extract the local time in seconds.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msgbuf</td><td>The block of GPS messages to process.</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tcp</td><td>A struct pointer used to pass thread data.</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gmtSeconds</td><td>The UTC time in seconds.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if a complete GPRMC message is found and the time was extracted. Else false. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00075">75</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00177">read_save()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/d28/pps-serial_8cpp_a21ca2cd625bad50c61e837880ac75c55_icgraph.svg" width="340" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a90b59dcade2c7323b79780215baae4fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90b59dcade2c7323b79780215baae4fd">&#9670;&nbsp;</a></span>makeSerialTimeQuery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int makeSerialTimeQuery </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the time from a serial port connected to a GPS receiver or equivalent and returns the difference in seconds from the local time to the true GPS time.</p>
<p>If a difference is detected, the error is verified by looking for an identical time difference from the next ten time difference checks. If the time difference repeats at least a total of eight times, the result is valid and is returned in g.serialTimeError. Otherwise the difference was an error and g.serialTimeError remains 0.</p>
<dl class="section return"><dt>Returns</dt><dd>0 or -1 on a system error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00312">312</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01250">waitForPPS()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/d28/pps-serial_8cpp_a90b59dcade2c7323b79780215baae4fd_icgraph.svg" width="320" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a98c41bc5e42885fab2e7f99876865476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c41bc5e42885fab2e7f99876865476">&#9670;&nbsp;</a></span>read_save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read_save </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>captureTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Converts a $GPRMC message s.ptimestr from the serial port to seconds and passes the result along with local time in seconds to <a class="el" href="../../df/d28/pps-serial_8cpp.html#a98c41bc5e42885fab2e7f99876865476">read_save()</a>;</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">captureTime</td><td>The time in microseconds into the current second at wich the $GPRMC message was captured and converted.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tcp</td><td>A struct pointer used to pass thread data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00177">177</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00075">getUTCfromGPSmessages()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/d28/pps-serial_8cpp_a98c41bc5e42885fab2e7f99876865476_cgraph.svg" width="340" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a017c6d120d7bd920065a7fece4d53978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a017c6d120d7bd920065a7fece4d53978">&#9670;&nbsp;</a></span>saveGPSTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void saveGPSTime </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads the GPS serial port once per second and saves the GPS time, gmt0Seconds, along with the local time, gmtSeconds, at which the GPS time was read, to a file that can be read by <a class="el" href="../../df/d28/pps-serial_8cpp.html#a90b59dcade2c7323b79780215baae4fd">makeSerialTimeQuery()</a>.</p>
<p>Because <a class="el" href="../../df/d28/pps-serial_8cpp.html#a98c41bc5e42885fab2e7f99876865476">read_save()</a> is called within 500 usecs after the rollover of the second, that has the consequence that the data saved by this function is one second old by the time it is read by <a class="el" href="../../df/d28/pps-serial_8cpp.html#a90b59dcade2c7323b79780215baae4fd">makeSerialTimeQuery()</a>.</p>
<p>However, the timestamps passed to <a class="el" href="../../df/d28/pps-serial_8cpp.html#a4749205b4ede5570376cf2d476014337">saveTimestamps()</a> allways correspond to the same second. So the only effect is to delay the reporting of a possible time error by one second.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tcp</td><td>A struct pointer used to pass thread data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00228">228</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00152">timeCheckParams::serialPort</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00155">timeCheckParams::strbuf</a>, and <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00364">writeToLog()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01250">waitForPPS()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/d28/pps-serial_8cpp_a017c6d120d7bd920065a7fece4d53978_cgraph.svg" width="263" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/d28/pps-serial_8cpp_a017c6d120d7bd920065a7fece4d53978_icgraph.svg" width="266" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4749205b4ede5570376cf2d476014337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4749205b4ede5570376cf2d476014337">&#9670;&nbsp;</a></span>saveTimestamps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int saveTimestamps </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gmt0Seconds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gmtSeconds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tv_usec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Saves timestamps of local time and GPS time to tcp-&gt;gmtTime_file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gmt0Seconds</td><td>The GPS timestamp. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gmtSeconds</td><td>The local time timestamp </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tcp</td><td>Structure containing the gmtTime_file filename. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../df/d28/pps-serial_8cpp_source.html#l00142">142</a> of file <a class="el" href="../../df/d28/pps-serial_8cpp_source.html">pps-serial.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00160">timeCheckParams::gmtTime_file</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00155">timeCheckParams::strbuf</a>, and <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00364">writeToLog()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../df/d28/pps-serial_8cpp_a4749205b4ede5570376cf2d476014337_cgraph.svg" width="286" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a06ca16ef16c65999f92e782aa19013bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06ca16ef16c65999f92e782aa19013bd">&#9670;&nbsp;</a></span>f</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct ppsFiles f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PPS-Client internal files. </p>
<p>PPS-Client internal files. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00058">58</a> of file <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html">pps-files.cpp</a>.</p>

</div>
</div>
<a id="a6fc43fe650a73ed6e4567288c6e1c6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fc43fe650a73ed6e4567288c6e1c6bd">&#9670;&nbsp;</a></span>g</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d1d/struct_g.html">G</a> g</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Declares the global variables defined in <a class="el" href="../../d4/d6a/pps-client_8h.html" title="This file contains includes, defines and structures for PPS-Client.">pps-client.h</a>. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00053">53</a> of file <a class="el" href="../../d5/d60/pps-client_8cpp_source.html">pps-client.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Dec 8 2020 13:43:25 for PPS-Client by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
