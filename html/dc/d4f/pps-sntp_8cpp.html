<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PPS-Client: client/pps-sntp.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PPS-Client
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">Client for synchronizing the system clock to a GPS PPS source</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_db3a54907829b36871118d03417739cd.html">client</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pps-sntp.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains functions and structures for accessing time updates via the NIST UDP time service.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../d4/d6a/pps-client_8h_source.html">../client/pps-client.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for pps-sntp.cpp:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d2f/pps-sntp_8cpp__incl.svg" width="147" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="../../dc/d4f/pps-sntp_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>nistLocalVars</b></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab07a50f0a8c691175d820b5a439e318a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#ab07a50f0a8c691175d820b5a439e318a">ADDR_LEN</a>&#160;&#160;&#160;17</td></tr>
<tr class="separator:ab07a50f0a8c691175d820b5a439e318a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8043d13f1150e0583d390c8eb5e07848"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#a8043d13f1150e0583d390c8eb5e07848">copyToLog</a> (char *logbuf, const char *msg)</td></tr>
<tr class="separator:a8043d13f1150e0583d390c8eb5e07848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8aaca53b26e1cb32310370e1b18ec81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#aa8aaca53b26e1cb32310370e1b18ec81">getNISTTime</a> (int id, char *strbuf, char *logbuf, time_t *timeDiff, char *<a class="el" href="../../d0/d3e/pps-files_8cpp.html#af1920905399afcfe32b9f3355f62889e">nistTime_file</a>)</td></tr>
<tr class="separator:aa8aaca53b26e1cb32310370e1b18ec81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa210dcf9646721cd7a6148d795257899"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#aa210dcf9646721cd7a6148d795257899">doTimeCheck</a> (<a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:aa210dcf9646721cd7a6148d795257899"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab74cbfa7869fa3bac58400981760a006"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#ab74cbfa7869fa3bac58400981760a006">getTimeConsensusAndCount</a> (void)</td></tr>
<tr class="separator:ab74cbfa7869fa3bac58400981760a006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad78b6046af5bbade4a7fc8941d689f44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#ad78b6046af5bbade4a7fc8941d689f44">updateLog</a> (char *buf, int numServers)</td></tr>
<tr class="separator:ad78b6046af5bbade4a7fc8941d689f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93e3d20b711f1db7e1e918246688460"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#aa93e3d20b711f1db7e1e918246688460">makeNISTTimeQuery</a> (<a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:aa93e3d20b711f1db7e1e918246688460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a715708bbeb9de8b18c103d6e5baad152"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#a715708bbeb9de8b18c103d6e5baad152">allocInitializeNISTThreads</a> (<a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:a715708bbeb9de8b18c103d6e5baad152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82679dd7549c68b79ac871bf9b90e81b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#a82679dd7549c68b79ac871bf9b90e81b">freeNISTThreads</a> (<a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *tcp)</td></tr>
<tr class="separator:a82679dd7549c68b79ac871bf9b90e81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6fc43fe650a73ed6e4567288c6e1c6bd"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="../../dc/d1d/struct_g.html">G</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#a6fc43fe650a73ed6e4567288c6e1c6bd">g</a></td></tr>
<tr class="memdesc:a6fc43fe650a73ed6e4567288c6e1c6bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Declares the global variables defined in <a class="el" href="../../d4/d6a/pps-client_8h.html" title="This file contains includes, defines and structures for PPS-Client.">pps-client.h</a>.  <a href="../../dc/d4f/pps-sntp_8cpp.html#a6fc43fe650a73ed6e4567288c6e1c6bd">More...</a><br /></td></tr>
<tr class="separator:a6fc43fe650a73ed6e4567288c6e1c6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06ca16ef16c65999f92e782aa19013bd"><td class="memItemLeft" align="right" valign="top">struct ppsFiles&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#a06ca16ef16c65999f92e782aa19013bd">f</a></td></tr>
<tr class="memdesc:a06ca16ef16c65999f92e782aa19013bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">PPS-Client internal files.  <a href="../../dc/d4f/pps-sntp_8cpp.html#a06ca16ef16c65999f92e782aa19013bd">More...</a><br /></td></tr>
<tr class="separator:a06ca16ef16c65999f92e782aa19013bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains functions and structures for accessing time updates via the NIST UDP time service. </p>

<p class="definition">Definition in file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab07a50f0a8c691175d820b5a439e318a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab07a50f0a8c691175d820b5a439e318a">&#9670;&nbsp;</a></span>ADDR_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADDR_LEN&#160;&#160;&#160;17</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00026">26</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a715708bbeb9de8b18c103d6e5baad152"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a715708bbeb9de8b18c103d6e5baad152">&#9670;&nbsp;</a></span>allocInitializeNISTThreads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int allocInitializeNISTThreads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocates memory and initializes threads that will be used by <a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#aa93e3d20b711f1db7e1e918246688460">makeNISTTimeQuery()</a> to query NIST time servers. Thread must be released and memory deleted by calling <a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#a82679dd7549c68b79ac871bf9b90e81b">freeNISTThreads()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tcp</td><td>Struct pointer for passing data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success or -1 on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00371">371</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01250">waitForPPS()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d4f/pps-sntp_8cpp_a715708bbeb9de8b18c103d6e5baad152_icgraph.svg" width="326" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8043d13f1150e0583d390c8eb5e07848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8043d13f1150e0583d390c8eb5e07848">&#9670;&nbsp;</a></span>copyToLog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void copyToLog </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>logbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00043">43</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00094">STRBUF_SZ</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00080">getNISTTime()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d4f/pps-sntp_8cpp_a8043d13f1150e0583d390c8eb5e07848_icgraph.svg" width="246" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa210dcf9646721cd7a6148d795257899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa210dcf9646721cd7a6148d795257899">&#9670;&nbsp;</a></span>doTimeCheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void doTimeCheck </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Requests a date/time from a NIST time server in a detached thread that exits after filling the <a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> struct, tcp, with the requested information and any error info.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tcp</td><td>struct pointer for passing data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00167">167</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00080">getNISTTime()</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00155">timeCheckParams::logbuf</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00095">LOGBUF_SZ</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00160">timeCheckParams::nistTime_file</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00148">timeCheckParams::serverIndex</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00149">timeCheckParams::serverTimeDiff</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00154">timeCheckParams::strbuf</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00094">STRBUF_SZ</a>, and <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00156">timeCheckParams::threadIsBusy</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d4f/pps-sntp_8cpp_aa210dcf9646721cd7a6148d795257899_cgraph.svg" width="262" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a82679dd7549c68b79ac871bf9b90e81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82679dd7549c68b79ac871bf9b90e81b">&#9670;&nbsp;</a></span>freeNISTThreads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freeNISTThreads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Releases threads and deletes memory used by <a class="el" href="../../dc/d4f/pps-sntp_8cpp.html#aa93e3d20b711f1db7e1e918246688460">makeNISTTimeQuery()</a>;</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tcp</td><td>The struct pointer that was used for passing data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00412">412</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00147">timeCheckParams::attr</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00152">timeCheckParams::buf</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00155">timeCheckParams::logbuf</a>, and <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00154">timeCheckParams::strbuf</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01250">waitForPPS()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d4f/pps-sntp_8cpp_a82679dd7549c68b79ac871bf9b90e81b_icgraph.svg" width="274" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa8aaca53b26e1cb32310370e1b18ec81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8aaca53b26e1cb32310370e1b18ec81">&#9670;&nbsp;</a></span>getNISTTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getNISTTime </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>strbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>logbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>timeDiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>nistTime_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets the time correction relative to the local clock setting in whole seconds provided by a NIST time server using the UDP protocol and queried by this shell command: </p><pre class="fragment">$ udp-time-client -u[n]
</pre><p>where [n] is the id described below. The timeDiff is assumed to be correct only if it is received within the current second. Because of internet delays and other errors UDP time servers do not always respond within a second. Consequently this function is used to query four timer serverss and a consensis of the possible error is obtained from them. The consensis error is added to the whole seconds of the system clock.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>An identifer recognized by udp-time-client to select a server and used for constructing a filename for server messages. id is in the range 1 to 4.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">strbuf</td><td>A buffer to hold server messages. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">logbuf</td><td>A buffer to hold messages for the error log. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">timeDiff</td><td>The time correction to be made. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nistTime_file</td><td>Filename to be used to transfer data from the shell to this program. Contains output from the udp-time-client shell command.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 or -1 on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00080">80</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00043">copyToLog()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp.html#aaf2d0a99430a6d5253b8c395c30ca7e3">gettimeofday()</a>, <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00097">NIST_MSG_SZ</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00041">nistTime_file</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00047">num</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00193">sysCommand()</a>, and <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00750">writeFileMsgToLogbuf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00167">doTimeCheck()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d4f/pps-sntp_8cpp_aa8aaca53b26e1cb32310370e1b18ec81_cgraph.svg" width="310" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d4f/pps-sntp_8cpp_aa8aaca53b26e1cb32310370e1b18ec81_icgraph.svg" width="262" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab74cbfa7869fa3bac58400981760a006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab74cbfa7869fa3bac58400981760a006">&#9670;&nbsp;</a></span>getTimeConsensusAndCount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getTimeConsensusAndCount </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Takes a consensus of the time error between local time and the time reported by NIST servers and reports the error as <a class="el" href="../../dc/d1d/struct_g.html#a08f6bcc62f997d7fa30937e3d2a82667" title="Consensus value of whole-second time corrections for DST or leap seconds from Internet NIST servers.">G.consensusTimeError</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>The number of NIST servers reporting. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00196">196</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00077">MAX_SERVERS</a>.</p>

</div>
</div>
<a id="aa93e3d20b711f1db7e1e918246688460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa93e3d20b711f1db7e1e918246688460">&#9670;&nbsp;</a></span>makeNISTTimeQuery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void makeNISTTimeQuery </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d1/d78/structtime_check_params.html">timeCheckParams</a> *&#160;</td>
          <td class="paramname"><em>tcp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>At an interval defined by CHECK_TIME, queries a list of NIST servers for date/time using detached threads so that delays in server responses do not affect the operation of the <a class="el" href="../../d5/d60/pps-client_8cpp.html#a22519b13ce414a4bf003faf65bd68144">waitForPPS()</a> loop.</p>
<p>Called each second.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tcp</td><td>Struct pointer for passing data. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00300">300</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01250">waitForPPS()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d4f/pps-sntp_8cpp_aa93e3d20b711f1db7e1e918246688460_icgraph.svg" width="300" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad78b6046af5bbade4a7fc8941d689f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad78b6046af5bbade4a7fc8941d689f44">&#9670;&nbsp;</a></span>updateLog()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateLog </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numServers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the PPS-Client log with any errors reported by threads querying NIST time servers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>The message buffer shared by the threads. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numServers</td><td>The number of NIST servers. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html#l00277">277</a> of file <a class="el" href="../../dc/d4f/pps-sntp_8cpp_source.html">pps-sntp.cpp</a>.</p>

<p class="reference">References <a class="el" href="../../d4/d6a/pps-client_8h_source.html#l00095">LOGBUF_SZ</a>, and <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00332">writeToLogNoTimestamp()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="../../dc/d4f/pps-sntp_8cpp_ad78b6046af5bbade4a7fc8941d689f44_cgraph.svg" width="310" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a06ca16ef16c65999f92e782aa19013bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06ca16ef16c65999f92e782aa19013bd">&#9670;&nbsp;</a></span>f</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct ppsFiles f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PPS-Client internal files. </p>
<p>PPS-Client internal files. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00058">58</a> of file <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html">pps-files.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l02233">accessDaemon()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00875">createPIDfile()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l02118">daemonSaveArray()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00804">getChildPID()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l01356">getConfigs()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l01801">getLinuxVersion()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l02540">getRootHome()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l01834">getRPiCPU()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l01273">getSharedConfigs()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00610">loadLastState()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00831">ppsIsRunning()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l01219">processWriteRequest()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00509">saveLastState()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l01999">showStatusEachSecond()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00435">writeStatusStrings()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l01581">writeTimestamp()</a>, <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00364">writeToLog()</a>, and <a class="el" href="../../d0/d3e/pps-files_8cpp_source.html#l00332">writeToLogNoTimestamp()</a>.</p>

</div>
</div>
<a id="a6fc43fe650a73ed6e4567288c6e1c6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fc43fe650a73ed6e4567288c6e1c6bd">&#9670;&nbsp;</a></span>g</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="../../dc/d1d/struct_g.html">G</a> g</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Declares the global variables defined in <a class="el" href="../../d4/d6a/pps-client_8h.html" title="This file contains includes, defines and structures for PPS-Client.">pps-client.h</a>. </p>

<p class="definition">Definition at line <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00053">53</a> of file <a class="el" href="../../d5/d60/pps-client_8cpp_source.html">pps-client.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00492">buildRawErrorDistrib()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00248">clampJitter()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00544">detectDelaySpike()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00766">detectExteralSystemClockChange()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00720">detectMissedPPS()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00903">doTimeFixups()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00138">getAcquireState()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00648">getIntegral()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00365">getMovingAverage()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00204">getTimeSlew()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00075">initialize()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00333">integralIsReady()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01407">main()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00295">makeAverageIntegral()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00976">makeTimeCorrection()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01134">readPPS_SetTime()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00601">removeNoise()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00674">savePPStime()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00830">setClockFractionalSecond()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00454">setClockToGPStime()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00415">setClocktoNISTtime()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l00162">setHardLimit()</a>, <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01086">setSyncDelay()</a>, and <a class="el" href="../../d5/d60/pps-client_8cpp_source.html#l01250">waitForPPS()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 25 2020 14:04:11 for PPS-Client by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
